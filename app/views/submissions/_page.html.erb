<%= will_paginate @submissions %>
<% if @submissions.length == 0 %>
  <% if current_user.id == params[:by_user] %>
    You have no submissions.
  <% else %>
    No submissions found.
  <% end %>
<% else %>

  <% @table_columns = 4 %>
  <table class="main_table hoverable">
    <thead>
      <tr>
        <th>Submission</th>
        <th>Language</th>
        <th>Score</th>
        <% if params[:by_user].nil?
             @table_columns+=1
        %>
          <th>User</th>
        <% end %>
        <% if params[:by_problem].nil?
             @table_columns+=1
        %>
          <th>Problem</th>
        <% end %>
        <th></th>
        <% if policy(Submission).update?
             @table_columns += 1
        %>
          <th></th>
        <% end %>
        <% if policy(Submission).destroy?
             @table_columns += 1
        %>
          <th></th>
        <% end %>
      </tr>
    </thead>
    <tbody>
  <% @submissions.each do |submission| %>
    <tr onClick="toggle_height(<%= "'submission#{submission.id}source'" %>);">
      <td><%= submission.created_at.strftime("%b %d %Y, %H:%M") %>
        <td><%= submission.language.name %></td>
      <td><%= submission.score %></td>
      <% if params[:by_user].nil? %>
        <td><% if submission.user %><%= handle(submission.user) %><% end %></td>
      <% end %>
      <% if params[:by_problem].nil? %>
        <td><%= submission.problem.name %></td>
      <% end %>
      <td><%= link_to 'Show', submission %></td>
      <% if policy(submission).update? %>
        <td><%= link_to 'Edit', edit_submission_path(submission) %></td>
      <% end %>
      <% if policy(submission).destroy? %>
        <td><%= link_to 'Destroy', submission, :data => { :confirm => 'Are you sure?' }, :method => :delete %></td>
      <% end %>
    </tr>
      <tr>
      <td colspan="<%= @table_columns %>" style="padding: 0px;"><pre id="submission<%= submission.id %>source" style="overflow-y: hidden; width: 100%; display: none; border: 0px; padding: 0px; margin: 0px;"><%= submission.source %></pre></td>
    </tr>
  <% end %>
    </tbody>
  </table>
<% end %>
<%= will_paginate @submissions %>

