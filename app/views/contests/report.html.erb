<script type="text/javascript">
window.setTimeout("window.location.reload(true);", 60000);
</script>
<div id="main-page-title">Contest Report: <%= @contest.title %></div>
<br />

<p>
   <%= @contest.num_competitors %> people competed in this contest. <br />
   <b>Start time:</b>  <%= @contest.start_time %><br />
   <b>End time:</b>    <%= @contest.end_time %><br />
   <b>Duration:</b>    <%= @contest.duration %><br />
</p>
<br />

<b>High Scorers</b>
<table class="main_table" >
  <tr>
    <th> User </th>
    <% @contest.problems.each do |problem|%>
      <th> <%= link_to problem.title, problem_path(problem) %> </th>
    <% end %>
    <th> Total Score </th>
    <th> Placing </th>
  </tr>

  <% @high_scorers.each do |person| %>
    <tr>
      <% u = User.find(person[:user]) %>
      <td> <%= u.email %> </td>
      <% @contest.problems.each do |prob|%>
        <td> <%= @contest.problem_score(u, prob) %> </td>
      <% end %>
      <td> <%= person[:score] %> </td>
      <td> <%= person[:placing] %> </td>
    </tr>
  <% end %>
</table>
<br />

<b>Problems</b>
<table class="main_table">
  <tr>
    <th> Name </th>
    <th> Your Score </th>
    <th> Correct Solutions </th>
  </tr>

  <% @problems.each do |problem| %>
    <tr>
      <td> <%= link_to problem.title, problem_path(problem) %> </td>
      <td> <%= @contest.problem_score(current_user, problem) %> </td>
      <td> <%= @contest.num_solved(problem) %> </td>
    </tr>
  <% end %>
</table>
<br />
<% if current_user.is_admin %>
  <%= render 'admin' %>
<% end %>

<div id="footer">
  <%= link_to 'Edit', edit_contest_path(@contest) %> |
  <%= link_to 'Back', contests_path %>
</div>
