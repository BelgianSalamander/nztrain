<html>
<head>
    <%= javascript_include_tag :defaults %>
    <%= javascript_include_tag "jquery.js" %>
    <%= javascript_include_tag "jquery-1.6.2.min.js"%>
    <%= javascript_include_tag :markitup %>
    <%= javascript_include_tag "jquery-ui-timepicker-addon.js" %>
    <%= javascript_include_tag "jquery.fileinput.js" %>
    <%= javascript_include_tag "jquery.countdown.js" %>

    <%= stylesheet_link_tag "jquery-ui-1.8.16.custom.css" %>
    <%= stylesheet_link_tag  "fileinput.css" %>
    <%= stylesheet_link_tag  "jquery.countdown.css" %>
    <%= stylesheet_link_tag :markitup %>
    <%= stylesheet_link_tag :all, :cache => false%>



    <%= csrf_meta_tag %>

<script type="text/javascript">
<!--
        function toggle_visibility(id,visible) {
           var e = document.getElementsByClassName(id);
           for (var i=0, len = e.length; i<len; i++)
              if(e[i].style.display == visible)
                 e[i].style.display = 'none';
              else
                 e[i].style.display = visible;
        }

        function createCookie(name,value,days) {
		if (days) {
			var date = new Date();
			date.setTime(date.getTime()+(days*24*60*60*1000));
			var expires = "; expires="+date.toGMTString();
		}
		else var expires = "";
		document.cookie = name+"="+value+expires+"; path=/";
	}

	function readCookie(name) {
		var nameEQ = name + "=";
		var ca = document.cookie.split(';');
		for(var i=0;i < ca.length;i++) {
			var c = ca[i];
			while (c.charAt(0)==' ') c = c.substring(1,c.length);
			if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
		}
		return null;
	}

	var duration = 250;

        function toggle_height(id) {
           var e = document.getElementById(id);
           if (e.style.display=="none") {
              var height = $('#'+id).height();
              e.style.height = "0px";
              e.style.display = "block";
              $("#"+id).animate({'height':height},duration, function() {
                 e.style.display = "inline-block";
              });
           }
           else if (e.style.display=="inline-block") {
              e.style.display = "block";
              var height = $('#'+id).height();
              $("#"+id).animate({'height':0},duration, function() {
                 e.style.display = "none";
                 $('#'+id).height(height);
              });
           }
        }

	function shrink() {
		createCookie("expanded", "false", 31);
		$("#side").animate({width:'100px'}, duration);
		$('#side-minify').animate({'margin-left':'73px'}, duration).html("&#9654;");
		$('#main-container').animate({'margin-left':'122px'}, duration);
		$('#main-message-container').animate({'margin-left':'122px'}, duration);
		$('#side-logo').animate({width:'95px', height: '112px'}, duration);
		$('#side-logo').animate({'margin-left':'2px', 'margin-top':'12px'}, duration);
		$('#uac-user').data('email', $('#uac-user').html()).html("<a href=\"/accounts/edit\">account</a>");
	}

	function expand() {
		createCookie("expanded", "true", 31);
		$("#side").animate({width:'300px'}, duration);
		$('#side-minify').animate({'margin-left':'273px'}, duration).html("&#9664;");
		$('#main-container').animate({'margin-left':'322px'}, duration);
		$('#main-message-container').animate({'margin-left':'322px'}, duration);
		$('#side-logo').animate({width:'270px', height: '320px'}, duration);
		$('#uac-user').html($('#uac-user').data('email'));
	}

	$(document).ready(function() {
		var expanded = readCookie("expanded");
		if(expanded == "false") {
			duration = 0;
			shrink();
			duration = 250;
		}
		$("#main").show();
		$('#side-minify').click(function() {
			if($('#side').width() == 100)
				expand();
			else
				shrink();
		});

		$("table tr").click(function() {
			$(this).toggleClass("main-table-highlight");
		});
	});
//-->
</script>
<title><%= yield :title %><%= "#{((yield :title).length>0?" - ":"")}NZOI Training" %></title>
</head>
<body>
<div id="side">
	<div id="side-minify">&#9664;</div>
   <div id="side-logo">
   </div>
   <div id="side-title">
     Training Site
   </div>
   <% if user_signed_in? %>
	   <div id="uac-user"><a href="/accounts/edit"><%= current_user.email %></a></div><br />
   <ul>
      <li><a href="<%= problem_sets_path %>">problem sets</a></li>
      <li><a href="<%= problems_path %>">problems</a></li>
      <li><a href="<%= contests_path %>">contests</a></li>
      <li><a href="<%= groups_path %>">groups</a></li>
	<li><a href="<%= users_path %>">users</a></li>
	<li class="nav-uac"><%= link_to "sign out", destroy_user_session_path, :method => :delete %></li>
   </ul>
   <% else %>
      <a href="<%= new_user_session_path %>">sign in</a>
   <% end %>

</div>

<div id="main">
	<div id="main-message-container">
	    Congratulations to our current brownie point leader <%= @brownie_leader.email %> who has <%= @brownie_leader.brownie_points %> points!<br />
	</div>
	<div id="main-container">
	      <% if alert %>
	        <p id="alert"><%= alert %></p>
              <% end %>
	      <% if flash[:notice] %>
	        <p id="alert"><%= flash[:notice] %></p>
	      <% end %>
	      <%= yield %>
	</div>
</div>
</body>
</html>
