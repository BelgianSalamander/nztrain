<html>
<head>
    <link rel="shortcut icon" href="favicon.ico">
    <%= javascript_include_tag :defaults %>
    <%= javascript_include_tag "jquery.js" %>
    <%= javascript_include_tag "jquery-1.6.2.min.js"%>
    <%= javascript_include_tag :markitup %>
    <%= javascript_include_tag "jquery-ui-timepicker-addon.js" %>
    <%= javascript_include_tag "jquery.fileinput.js" %>
    <%= javascript_include_tag "jquery.countdown.js" %>
    <%= javascript_include_tag "jquery.ba-bbq.min.js" %>

    <%= stylesheet_link_tag "jquery-ui-1.8.16.custom.css" %>
    <%= stylesheet_link_tag  "fileinput.css" %>
    <%= stylesheet_link_tag  "jquery.countdown.css" %>
    <%= stylesheet_link_tag :markitup %>
    <%= stylesheet_link_tag :all, :cache => false%>

    <%= javascript_include_tag 'pagination' %>

    <%= csrf_meta_tag %>

<script type="text/javascript">
<!--
        function createCookie(name,value,days) {
		if (days) {
			var date = new Date();
			date.setTime(date.getTime()+(days*24*60*60*1000));
			var expires = "; expires="+date.toGMTString();
		}
		else var expires = "";
		document.cookie = name+"="+value+expires+"; path=/";
	}

	function readCookie(name) {
		var nameEQ = name + "=";
		var ca = document.cookie.split(';');
		for(var i=0;i < ca.length;i++) {
			var c = ca[i];
			while (c.charAt(0)==' ') c = c.substring(1,c.length);
			if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
		}
		return null;
	}

        var expandspeed = 1;
        var minduration = 250;
        function toggle_height(id, displaytype) {
           if ($("#"+id).data("height")==undefined) {
              $("#"+id).data("height",$('#'+id).height());
              $("#"+id).data("state",0);
              var e = document.getElementById(id);
              e.style.height = "0px";
              e.style.display = ((typeof(displaytype)=="undefined")?"block":displaytype);
           }
           if ($("#"+id).data("state")==0) {
              $("#"+id).stop();
              $("#"+id).animate({'height':$("#"+id).data("height")},Math.max(($("#"+id).data("height")-$("#"+id).height())/expandspeed,minduration));
              $("#"+id).data("state",1);
           }
           else {
              $("#"+id).stop();
              $("#"+id).animate({'height':0},Math.max($("#"+id).height()/expandspeed,minduration));
              $("#"+id).data("state",0);
           }
        }

	var duration = 250;
	function shrink() {
		createCookie("expanded", "false", 31);
		$("#side").animate({width:'100px'}, duration);
		$('#side-minify').animate({'margin-left':'73px'}, duration).html("&#9654;");
		$('#main-container').animate({'margin-left':'122px'}, duration);
		$('#main-message-container').animate({'margin-left':'122px'}, duration);
		$('#side-logo').animate({width:'95px', height: '112px'}, duration);
		$('#side-logo').animate({'margin-left':'2px', 'margin-top':'12px'}, duration);
		$('#uac-user').data('email', $('#uac-user').html()).html("<a href=\"/accounts/edit\">account</a>");
	}

	function expand() {
		createCookie("expanded", "true", 31);
		$("#side").animate({width:'300px'}, duration);
		$('#side-minify').animate({'margin-left':'273px'}, duration).html("&#9664;");
		$('#main-container').animate({'margin-left':'322px'}, duration);
		$('#main-message-container').animate({'margin-left':'322px'}, duration);
		$('#side-logo').animate({width:'270px', height: '320px'}, duration);
		$('#uac-user').html($('#uac-user').data('email'));
	}

	$(document).ready(function() {
		var expanded = readCookie("expanded");
		if(expanded == "false") {
			duration = 0;
			shrink();
			duration = 250;
		}
		$("#main").show();
		$('#side-minify').click(function() {
			if($('#side').width() == 100)
				expand();
			else
				shrink();
		});

		$("table tr").click(function() {
			$(this).toggleClass("main-table-highlight");
		});
	});
//-->
</script>
<title><%= yield :title %><%= "#{((yield :title).length>0?" - ":"")}NZOI Training" %></title>
</head>
<body>
<div id="side">
	<div id="side-minify">&#9664;</div>
   <div id="side-logo">
   </div>
   <div id="side-title">
     Training Site
   </div>
   <% if user_signed_in? %>
	   <div id="uac-user"><a href="/accounts/edit"><%= current_user.email %></a></div><br />
   <ul>
      <li><a href="<%= problem_sets_path %>">problem sets</a></li>
      <li><a href="<%= problems_path %>">problems</a></li>
      <li><a href="<%= contests_path %>">contests</a></li>
      <li><a href="<%= groups_path %>">groups</a></li>
      <li><a href="<%= submissions_path %>">submissions</a></li>
      <li><a href="<%= users_path %>">users</a></li>
      <li class="nav-uac"><%= link_to "sign out", destroy_user_session_path, :method => :delete %></li>
   </ul>
   <% else %>
      <a href="<%= new_user_session_path %>">sign in</a>
   <% end %>

</div>

<div id="main">
	<div id="main-message-container">
	    Congratulations to our current brownie point leader <%= @brownie_leader.email %> who has <%= @brownie_leader.brownie_points %> points!<br />
	</div>
	<div id="main-container">
	      <% if alert %>
	        <p id="alert"><%= alert %></p>
              <% end %>
	      <% if flash[:notice] %>
	        <p id="alert"><%= flash[:notice] %></p>
	      <% end %>
	      <%= yield %>
              <div id="footer">/usr/bin/time -f "%e seconds" curl --silent <%= request.url %> &gt; /dev/null<br />$responsetime seconds</div>
	</div>

</div>
</body>
</html>
